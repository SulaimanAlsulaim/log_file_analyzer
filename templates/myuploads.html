{% extends "base.html" %}

{% block title %}My Uploads{% endblock %}

{% block content %}
<div class="uploads-container">
  <h2 style="margin-bottom: 40px;">My Uploaded Logs</h2>

  <div class="card">
    <div class="card-body">
      {% if uploads %}
      <table class="table">
        <thead>
          <tr>
            <th>File Name</th>
            <th>Size</th>
            <th>Upload Date</th>
            <th>Options</th>
          </tr>
        </thead>
        <tbody>
          {% for upload in uploads %}
          <tr>
            <td>{{ upload.filename }}</td>
            <td>{{ upload.size_readable }}</td>
            <td>{{ upload.uploaded_at.strftime('%Y-%m-%d %H:%M') }}</td>
            <td>

              <div class="btn-group">
                <button type="button" class="btn btn-primary btn-sm dropdown-toggle" data-bs-toggle="dropdown">
                  Download
                </button>

                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="{{ url_for('download_upload', upload_id=upload.id) }}">
                      Raw Log
                    </a>
                  </li>

                  {% if upload.structured_log %}
                  <li>
                    <a class="dropdown-item" href="{{ url_for('upload.download_result', log_id=upload.id) }}">
                      Result Log
                    </a>
                  </li>
                  {% endif %}

                </ul>
              </div>

              <a href="{{ url_for('delete_upload', upload_id=upload.id) }}">
                <button class="btn btn-danger btn-sm">Delete</button>
              </a>

            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p>No uploads found.</p>
      {% endif %}
    </div>
  </div>

  <a class="back-link" href="{{ url_for('upload.upload_file') }}">‚Üê Back to Upload</a>
</div>
{% endblock %}
